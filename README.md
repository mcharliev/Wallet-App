# Структура домашних заданий для отбора на стажировку в компанию Y_LAB

## Описание
Этот репозиторий содержит решения для домашних заданий по курсу. Каждое задание представляет собой усовершенствование сервиса управления кредитными/дебетовыми транзакциями.


## ДЗ №1
### Описание
Реализация базовой версии сервиса управления кредитными/дебетовыми транзакциями. 

### Требования
данные хранятся в памяти приложений
приложение должно быть консольным (никаих спрингов, взаимодействий с БД и тд, только java-core и collections)
регистрация игрока
авторизация игрока
Текущий баланс игрока
Дебет/снятие средств для каждого игрока Дебетовая транзакция будет успешной только в том случае, если на счету достаточно средств (баланс - сумма дебета >= 0). - Вызывающая сторона предоставит идентификатор транзакции, который должен быть уникальным для всех транзакций. Если идентификатор транзакции не уникален, операция должна завершиться ошибкой.
Кредит на игрока. Вызывающая сторона предоставит идентификатор транзакции, который должен быть уникальным для всех транзакций. Если идентификатор транзакции не уникален, операция должна завершиться ошибкой.
Просмотр истории пополнения/снятия средств игроком
Аудит действий игрока (авторизация, завершение работы, пополнения, снятия и тд)

## ДЗ №2
### Описание
Доработка сервиса с использованием базы данных PostgreSQL.

### Требования
Репозитории теперь должны писать ВСЕ сущности в БД PostgreSQL
Идентификаторы при сохранении в БД должны выдаваться через sequence
DDL-скрипты на создание таблиц и скрипты на предзаполнение таблиц должны выполняться только инструментом миграции Liquibase
Скрипты миграции Luiqbase должны быть написаны только в нотации XML
Скриптов миграции должно быть несколько. Как минимум один на создание всех таблиц, другой - не предзаполнение данными
Служебные таблицы должны быть в отдельной схеме
Таблицы сущностей хранить в схеме public запрещено
В тестах необходимо использовать test-containers
В приложении должен быть docker-compose.yml, в котором должны быть прописаны инструкции для развертывания postgre в докере. Логин, пароль и база должны быть отличными от тех, что прописаны в образе по-умолчанию. Приложение должно работать с БД, развернутой в докере с указанными параметрами.
Приложение должно поддерживать конфиг-файлы. Всё, что относится к подключению БД, а также к миграциям, должно быть сконфигурировано через конфиг-файл

## ДЗ №3
### Описание
Обновление сервиса Wallet-Service.

### Требования
Все взаимодействие должно теперь осуществляться через отправку HTTP запросов
Сервлеты должны принимать JSON и отдавать также JSON
Использовать понятное именование эндпоинтов
Возвращать разные статус-коды
Добавить DTO (если ранее не было заложено)
Для маппинга сущностей в дто использовать MapStruct
Реализовать валидацию входящих ДТО
Аудит переделать на аспекты
Также реализовать на аспектах выполнение любого метода (с замером времени выполнения)
Сервлеты должны быть покрыты тестами
Метод логина должен выдавать JWT, остальные методы должны быть авторизационными и валидировать JWT
(В требования добавляется выдача токена и авторизация последующих запросов.)

## ДЗ №4
### Описание
Расширение функционала сервиса с применением Spring и других технологий.

### Требования
Необходимо обновить сервис, который вы разработали в первом задании согласно следующим требованиям и ограничениям.
Требования:
Java-конфигурация приложения
Кастомные конфигурационные файлы заменить на application.yml
Удалить сервлеты, реализовать Rest-контроллеры (Spring MVC)
Swagger + Swagger UI
Аспекты переписать на Spring AOP
Внедрение зависимостей ТОЛЬКО через конструктор
Удалить всю логику создания сервисов, репозиториев и тд. Приложение должно полностью управляться спрингом
Добавить тесты на контроллеры (WebMVC)

## ДЗ №5
### Описание
Переписать приложение с учетом добавления функционала Spring Boot

### Требования
Spring Boot 3.2.0 с использованием необходимых стартеров
Обновить тесты
Аспекты аудита и логирования вынести в стартер, сделать отдельным модулем. Один стартер должен автоматически подключаться, второй через аннотацию @EnableXXX
Swagger -> SpringDoc

### Эндпоинты

#### 1. Регистрация игрока
   - Тип запроса: POST
   - URL: `http://localhost:8080/players/register`
   - Тело запроса:
     ```json
     {
       "username": "Player",
       "password": "353062"
     }
     ```

#### 2. Вход для игрока
   - Тип запроса: POST
   - URL: `http://localhost:8080/players/login`
   - Тело запроса:
     ```json
     {
       "username": "Player",
       "password": "353062"
     }
     ```
   - После успешного выполнения этого запроса, вы получите токен. Сохраните его для следующих запросов.

#### 3. Кредитная транзакция
   - Тип запроса: POST
   - URL: `http://localhost:8080/transactions/credit`
   - Тело запроса:
     ```json
     {
       "amount": 100
     }
     ```

#### 4. Дебетовая транзакция
   - Тип запроса: POST
   - URL: `http://localhost:8080/transactions/debit`
   - Тело запроса:
     ```json
     {
       "amount": 90
     }
     ```

#### 5. Просмотр баланса игрока
   - Тип запроса: GET
   - URL: `http://localhost:8080/players/balance`

#### 6. Просмотр истории транзакций игрока
   - Тип запроса: GET
   - URL: `http://localhost:8080/transactions/history`

### Аутентификация
Для запросов, требующих аутентификации, используйте полученный токен после входа:
1. В Postman, выберите раздел "Аутентификация".
2. Из выпадающего меню выберите "Bearer Token".
3. Вставьте ваш токен в поле "Token".
